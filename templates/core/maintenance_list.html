{% extends 'core/base.html' %}
{% block content %}
  <h2>Danh sách yêu cầu bảo trì</h2>
  <a class="button" href="{% url 'maintenance_create' %}">Tạo yêu cầu</a>
  <table>
    <thead><tr><th>ID</th><th>Thiết bị</th><th>Vị trí</th><th>Mô tả</th><th>Trạng thái</th><th>Người gửi</th><th>Hành động</th></tr></thead>
    <tbody>
      {% for r in requests %}
        <tr>
          <td>{{ r.id }}</td>
          <td>{{ r.equipment }}</td>
          <td>
            {{ r.equipment.room.floor.building.name }} / Tầng {{ r.equipment.room.floor.number }} / Phòng {{ r.equipment.room.code }}
          </td>
          <td>{{ r.description }}</td>
          <td>{{ r.get_status_display }}</td>
          <td>{{ r.created_by }}</td>
          <td>
            {% if user.is_superuser %}
              <a href="{% url 'maintenance_update' r.pk %}">Cập nhật</a>
            {% endif %}
          </td>
        </tr>
      {% empty %}
        <tr><td colspan="6">Không có yêu cầu</td></tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
